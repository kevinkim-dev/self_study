# CS_Study_정보처리기사 5주차

> 04.28~05.04
>
> 제 3과목 데이터베이스 구축 - 4) SQL 활용
>
> 113장~119장
>
> by. 김승현



## 113. 프로시져



### 프로시져

- 프로시져(Procedure)는 절차형 SQL을 활용하여 특정 기능을 수행하는 트랜잭션 언어로, 미리 저장해 놓은 sql 작업을 수행한다
- 프로스져를 미리 만들어 놓으면 다른 프로그램에서도 사용 가능하며, 저장되어 있어서 stored procedure라고도 부른다.
- 시스템의 일일 마감 작업, 일괄(Batch) 작업에도 쓰인다

- 구성

  - DECLARE: 프로시저의 명칭, 변수, 인수, 데이터 타입을 정의
  - BEGIN / END: 프로시저의 시작과 종료를 의미
  - CONTROL: 조건문 혹은 반복문
  - SQL: DML, DCL 이 삽입되어 데이터 관리
  - EXCEPTION: BEGIN~END 사이에서 예외 발생 시 처리
  - TRANSECTION: 수행한 작업을 DB에 적용할지 취소할지 결정

- 생성

  ```
  CREATE [OR REPLACE] PROCEDURE 프로시저명(파라미터)
  [지역변수 선언]
  BEGIN
  	프로시져 BODY
  END;
  ```

- 실행

  ```
  EXECUTE 프로시저명;
  EXEC 프로시저명;
  CALL 프로시저명;
  ```

- 제거

  ```
  DROP PROCEDURE 프로시저명;
  ```



### 기출문제 따라잡기

1. 프로시저에 대한 설명으로 옳지 않은 것은?

   프로시저는 저장되었다가 추후 다시 사용될 수 있다

2. 프로시저의 구성요소에 대해 잘못된 것은?

   Exception은 Begin ~ end에서 오류가 발생한 경우 처리하는 것이다]

3. 데이터베이스에서 프로그래밍 언어와 같이 연속적인 실행이나 분기, 반복등의 제어가 가능한 sQL을 뭐라고 하는가?

   절차형 SQL 이라고 한다

4. DB에 저장된 'new_Test'라는 프로시저를 제거하고자 할때 작성할 SQL문으로 옳은 것은?

   DROP을 사용한다.

5. 다음 DDL을 통해 생성된 프로시저에 대한 설명으로 옳지 않은 것은?

   OR REPLACE가 없으므로 대체하지 않는다

6. 프로시저를 실행 또는 호출하기위한 표기 형식에 해당하지 않는 것은?

   프로시저 실행방법에는 EXECUTE, EXEC, CALL이 있다.





## 114. 트리거



### 트리거

- 데이터의 삽입, 갱신, 삭제 등의 이벤트가 발생할 때 관련 작업이 자동으로 수행되는 절차형 SQL이다

- 프로시져와 비슷한 구조로 되어있지만, EVENT가 추가되어, EVENT를 명시해야 한다
- 생성은 CREATE, 삭제는 DROP을 사용한다
- 동작시기로 BEFORE혹은 AFTER를 설정하여 테이블 변경 전 혹은 후에 실행할 지 선택한다.



### 기출문제 따라잡기

1. 데이터베이스 시스템에서 삽입, 갱신, 삭제 등의 이벤트가 발생할 때 자동으로 수행되는 절차형 SQL은?

   트리거 라고 한다

2. 트리거의 목적에 해당하지 않는 것은?

   트리거는 권한 변경을 하지 않는다

3. 다음 구성요소에 대한 설명으로 옳지 않은 것은?

   EVENT에는 삽입, 갱신, 삭제가 일어날 때 상황이 주어진다. CREATE와 ALTER는 테이블을 수정하는 것이다.

4. 다음 SQL문장에 대한 설명으로 잘못된 것은?

   0이 아닌 경우에 실행한다

5. 트리거를 제거하는 SQL 명령어는?

   트리거도 DROP을 사용한다





### 115. 사용자 정의 함수



### 사용자 정의 함수

- 프로시저와 유사하게 SQL을 활용하여 일련의 작업을 연속적으로 처리하며 종료시 결과를 리턴하는 절차형 SQL이다
- 데이터베이스에 저장되어, SELECT, INSERT등 DML문 내부에서 호출되어 사용된다.
- 사용자 정의 함수는 RETURN을 통해 값을 반환하기 때문에 출력 파라미터가 없다
- 테이블 조작은 할 수 없고, SELECT를 통해 조회만 할 수 있다.
- 프로시저를 호출할 수 없다.
- SUM(), AVG()와 같은 반환값을 활용하기 위한 용도로 사용된다.

- 구성

  - DECLARE
  - BEGIN
  - CONTROL
  - SQL
  - EXCEPTION
  - RETURN(필수): 반환할 값이나 변수를 지정한다
  - END

- 생성

  ```
  CREATE [OR REPLACE] FUNCTION 사용자 정의 함수명
  [지역변수 선언]
  BEGIN
  	사용자 정의 함수 BODY;
  	RETURN 반환값;
  END;
  ```

- 삭제

  ```
  DROP FUNCTION 함수명;
  ```

- 실행

  DML에서 속성명이 놓을 자리에 대체하여 사용한다.

  SELECT, VALUSE, WHERE, SET 등의 뒤에서 사용한다.



### 기출문제 따라잡기

1. DBMS에서 사용자 정의 함수에 대한 설명으로 옳은 것은?

   DML문에서 function name을 적어서 불러와서 사용한다.

2. 프로시저와 사용자 정의 함수에 대한 설명으로 옳지 않은 것은?

   사용자 정의 함수는 출력 파라미터가 없다. in만 있다.

3. 직위와 연차를 이용하여 연봉을 계산하는 사용자 정의 함수 salary를 이용하여 조회하는 명령문은?

   SELECT 사원번호, 이름 salary(직위, 연차) AS 연봉 FROM 사원;

4. 빈칸에 들어갈 단어로 알맞게 짝지어진 것은?

   BEGIN으로 수행할 BODY를 감싸야 하며, RETURN문은 필수이다.



## 116. DBMS 접속 기술



### DBMS 접속

- 데이터를 사용하기 위해 응용 시스템을 이용하여 DBMS에 접근하는 것
- 