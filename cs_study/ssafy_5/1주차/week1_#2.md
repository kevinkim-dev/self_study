# 프로세스와 스레드의 차이를 설명해보아라.

`프로세스에 대해 알아보자`

> Process(프로세스)



- 많이들 햇갈려 하지만 Process와 Program은 다르다. 
  Program을 실행하여 메모리에 올라가면 Process가 되는 것이다.

  > C:\Program Files (x86)\Kakao\KakaoTalk 에 들어있는 모든 파일 = 카카오톡 Program
  >
  > KakaoTalk.exe를 더블클릭하는 순간부터 끌 때까지 = 카카오톡 Process

- Process는 컴퓨터에서 연속적으로 실행되고 있는 컴퓨터 프로그램이며, 운영체제로부터 시스템 자원을 할당받은 작업의 단위이다

- Process는 4개의 독립된 메모리영역(Code, Data, Stack, Heap)을 할당 받는다.

  - 간단한 코드를 통해 알아보는 Process 메모리 영역

    ```python
    def enQueue(a, b):
        c = 2
        return a.append(b+2)
    
    x = []
    y = 2
    enQueue(x, y)
    ```

    - Code 영역: 말 그대로 실행 될 코드가 저장 된 공간이다. 실행 도중 변경되면 안되므로 Read-Only이며 수정할 수 없다.

    - Data 영역: 코드에서 선언한 전역변수 또는 static 변수 등이 저장된 공간이다. 

      > 위의 코드에서 y는 함수 밖에서 선언되었으므로 전역변수이다. 따라서 Data 영역에 저장된다.

    - Stack 영역: 지역변수와 매개변수, 리턴 값, 돌아올 주소 등등이 저장되는 공간이며, 함수 호출 시 기록하고, 종료되면 제거한다.

      > a와 b는 함수 enQueue를 실행하며 받아온 매개변수이고, c는 함수 enQueue를 실행하며 받아 온 지역변수이므로 Stack에 저장되어 사용된다.
      > return 값인 a.append(b+2)도 Stack에 저장되며, 함수가 끝나고 돌아가야 할 원래 코드 자리인 "7번째 줄"이란 데이터도 Stack에 저장된다.

    - Heap 영역: 데이터 배열의 크기가 확실하지 않고 변동이 있는 [**동적 할당**]()이 필요한 데이터가 저장되는 공간. 

      > x는 list type으로 동적 배열이 필요한 container type이다. 따라서 Heap 영역에 저장된다.

- Process는 독립된 메모리를 할당받으므로 서로의 자원에 접근하려면 프로세스 간의 통신(IPC, Inter-Process Communication)을 사용해야한다.



`Process와 Thread는 비교가 가능한가..?`

> Thread ⊂ Process



- 모든 Process는 최소 한 개의 Thread를 가지며 이 것을 Main Thread 라고 부른다.

- Thread는 Process가 할당 받은 메모리를 이용하는 실행 흐름의 단위를 말한다.

- 앞서 말했듯 모든 Process는 최소 한개의 Main Thread를 가지고 있다. 즉 [포함관계]()를 갖고 있다는 것이다. 
- 최소 한개라 함은 여러개의 Thread가 포함되어 있을 수도 있다는 것이다. 
- Thread가 여러 개인 경우 Thread는 자신의 Process의 Code, Data, Heap은 공유하고, Stack은 따로 할당 받는다.





`그러면 뭘 비교해야 할까...?`

> MultiProcess  vs  MultiThread



- 지극히 주관적인 생각이지만, 문제의 요지는 MultiProcess와 MultiThread를 비교하는 것 같다.

  - (이번에도) 서브웨이를 통해 알아보는 차이점

    > 서브웨이에서는 샌드위치를 내기 위해 3가지 Task를 해야합니다
    >
    > 1. 주문을 받아서 빵을 가르고 안에 내용물을 채웁니다. 
    > 2. 소스를 뿌리고 샌드위치를 포장합니다.
    > 3. 손님에게 샌드위치를 건내며 계산합니다.
    >
    > ※ 직원을 Process 혹은 Thread, 샌드위치를 메모리라고 생각하면 편합니다.

- MultiProcess: 여러 개의 Process가 한 가지 일을 같이 수행하는 것. 여러개의 Process가 협업하기 위해서 돌아가면서 CPU를 사용해야 하므로 Context Switching 이 필요하다.

  > 서브웨이 A점에서는 3명의 직원이 각각 손님을 따로 받습니다.
  > 즉 모든 직원이 1, 2, 3 과정을 다 배워 직접 진행합니다.

  - 장점

    - Process 하나에 문제가 발생해도, 서로 각기 다른 메모리 공간을 사용하므로 다른 Process는 영향을 받지 않는다.

      > 직원이 한 명 다쳐도 나머지 둘이 샌드위치를 만들 수 있으므로 손님을 받는데는 문제가 없습니다.

  - 단점

    - Context Switching이 MultiThread보다 비용이 많이 든다

      > 빵(메모리)을 들고 이동해가면서 작업을 다 해야하므로 속도가 느릴 수 있습니다.

    - Process 끼리 메모리를 공유하지 않아 IPC를 이용한 통신을 사용해야 한다. 

      >한 직원(Process)이 손님으로 아이유를 받았는데, 아쉽게도 다른 직원들은 그 직원이 말해주기 전까지 매장에 아이유가 왔다갔는지 알 수 없습니다.

- MultiThread: 한 Process 안의 여러 개의 Thread가 한가지 일을 함께 수행하는 것. Thread 끼리도 협업하기 위해서는 Context Switching 이 필요하다. 

  > 서브웨이 B점에서는 3명의 직원이 각각 1, 2, 3번 작업을 하나씩만 배워 분업합니다.
  > 예를들면 직원 a가 빵을 가르고 내용물을 채워서 직원 b에게 건내면, 소스를 뿌리고 포장해서 직원 c에게 건내고, c는 계산을 합니다. 
  >
  > 본인이 배운 작업 외에는 할 줄 모릅니다.

  - 장점

    - Context Switching 비용이 MultiProcess 보다 적게 든다

      > 빵을 들고 이동할 필요 없이 제자리에서 일만 하므로 속도가 빠릅니다

    - IPC를 이용하지 않아도 된다.

      > 다행히 여기서는 아이유가 왔다 가면 모든 직원이 일하면서 아이유를 한번씩 만날 수 있습니다.

    - 응답 시간이 적게 걸려서 빠르다

  - 단점

    - Thread 하나에 문제가 발생하면, Heap을 공유하므로 다른 Thread 전부에 문제가 발생한다.

      > 직원 중 한명이 다치면, 그 직원이 맡은 일을 할 수 있는 직원이 없으므로 더 이상 샌드위치를 만들 수 없습니다.

